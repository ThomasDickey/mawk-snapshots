# $MawkId: Makefile.in,v 1.6 2023/07/26 23:15:24 tom Exp $
###############################################################################
# copyright 2010-2020,2023 Thomas E. Dickey
#
# This is a source file for mawk, an implementation of
# the AWK programming language.
#
# Mawk is distributed without warranty under the terms of
# the GNU General Public License, version 2, 1991.
###############################################################################
# produce alternate forms from mawk's documentation.

SHELL=/bin/sh

srcdir		= @srcdir@
VPATH		= @srcdir@

prefix          = @prefix@
datarootdir     = @datarootdir@

mandir		= @mandir@

INSTALL         = @INSTALL@
INSTALL_DATA    = @INSTALL_DATA@

# these are overridden by top-level makefile
PROGRAM		= mawk
TOPIC		=
SECTION		= 1

# what/where to put the man pages (do not override)
MANDIR          = $(DESTDIR)$(mandir)
TARGET_DIR	= $(MANDIR)/man$(SECTION)
SOURCE_FILE	= mawk$(TOPIC).$(SECTION)
TARGET_FILE	= $(PROGRAM)$(TOPIC).$(SECTION)

.SUFFIXES : .html .$(SECTION) .man .ps .pdf .doc .txt

.$(SECTION).html :
	../man2html.tmp $* $(SECTION) man >$@

.$(SECTION).ps :
	$(SHELL) -c "tbl $*.$(SECTION) | groff -man" >$@

.$(SECTION).doc :
	GROFF_NO_SGR=stupid $(SHELL) -c "tbl $*.$(SECTION) | nroff -Tascii -man" >$@

.$(SECTION).txt :
	GROFF_NO_SGR=stupid $(SHELL) -c "tbl $*.$(SECTION) | nroff -Tascii -man | col -bx" >$@

.ps.pdf :
	ps2pdf $*.ps

ALL	= \
	$(PROGRAM).html \
	$(PROGRAM).pdf \
	$(PROGRAM).ps

all:	$(PROGRAM).txt $(PROGRAM).doc $(ALL)

install: $(TARGET_DIR)
	@echo "$@ing $(TARGET_DIR)/$(TARGET_FILE) manpage"
	@$(INSTALL_DATA) $(SOURCE_FILE) $(TARGET_DIR)/$(TARGET_FILE)

uninstall:
	@echo "$@ing $(TARGET_DIR)/$(TARGET_FILE) manpage"
	@-rm -f $(TARGET_DIR)/$(TARGET_FILE)

clean:
	-rm -f $(ALL)

distclean: clean
	rm -f Makefile

maintainer-clean: clean
	rm -f $(PROGRAM).txt $(PROGRAM).doc

$(PROGRAM).pdf : $(PROGRAM).ps

$(TARGET_DIR) :
	mkdir -p "$@"
